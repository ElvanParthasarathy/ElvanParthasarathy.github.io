/* =========================================
   MOBILE LAYOUT (Native Body Scroll)
   Applies only to screens smaller than 768px
========================================= */
@media screen and (max-width: 768px) {

    /* --- A. UNLOCK THE SHELL (Let the Window Scroll) --- */
    html, body {
        overflow-y: auto !important; 
        overflow-x: hidden;
        position: static !important;
        height: auto !important;
        background: #f4f4f4;
        overscroll-behavior-y: auto; 
    }

    .app-shell {
        display: block !important;
        height: auto !important;
        min-height: 100vh;
        overflow: visible !important;
        position: relative;
    }

    /* --- B. HEADER (Floating on Top) --- */
    .mobile-header {
        display: flex !important;
        align-items: center;
        justify-content: space-between;
        position: fixed !important;
        top: 0; left: 0; right: 0;
        height: 65px;
        padding: 0 20px;
        background: #f4f4f4;
        z-index: 1000;
        transition: none !important;
        
        /* FIX: Ensure no borders/shadows/radius leak from desktop */
        border: none !important;
        box-shadow: none !important;
        border-radius: 0 !important;
    }

    /* HEADER SCOOPS */
    .mobile-header::before, .mobile-header::after {
        content: ""; position: absolute; bottom: -30px; 
        width: 40px; height: 30px; z-index: 1000; pointer-events: none;
    }
    .mobile-header::before {
        left: 0; 
        background: radial-gradient(circle at bottom right, transparent 30px, #f4f4f4 30.5px);
    }
    .mobile-header::after {
        right: 0;
        background: radial-gradient(circle at bottom left, transparent 30px, #f4f4f4 30.5px);
    }

    .mobile-header .brand { display: block !important; font-size: 24px; font-weight: 800; padding: 0; letter-spacing: -0.5px; line-height: 1; }
    .mobile-actions { display: flex; gap: 10px; align-items: center; }

    /* About Pill - Updated to Light Grey (Matching Settings) */
    .about-pill {
        display: flex; align-items: center; gap: 8px;
        padding: 6px 16px; 
        background: rgba(0,0,0,0.05); /* Light Grey */
        color: #000; /* Black Text */
        border-radius: 30px; font-size: 13px; font-weight: 600; text-decoration: none;
        transition: transform 0.15s cubic-bezier(0.34, 1.56, 0.64, 1), background 0.2s ease;
    }
    .about-pill:active { 
        transform: scale(0.92); 
        background: rgba(0,0,0,0.1); /* Slightly darker on press */
    }
    .about-pill img { 
        width: 18px; 
        filter: none; /* Keep icon black */
    }
    
    .settings-btn-small {
        width: 36px; height: 36px; border-radius: 50%; background: rgba(0,0,0,0.05);
        display: flex; align-items: center; justify-content: center;
        transition: transform 0.2s ease, background 0.2s ease;
    }
    .settings-btn-small:active { transform: scale(0.9) rotate(15deg); background: rgba(0,0,0,0.1); }
    .settings-btn-small img { width: 22px; height: 22px; object-fit: contain; }

    /* --- C. MAIN AREA --- */
    .main-content {
        display: block !important;
        width: 100%; margin: 0 !important; padding: 0 !important;
        padding-top: 65px !important;
        padding-bottom: 100px !important;
        min-height: 100vh;
        overflow: visible !important;
        transition: none !important;
    }

    /* --- D. CONTENT CARD --- */
    #content-area {
        display: block; background: #fff; width: auto;
        height: auto !important; 
        min-height: calc(100vh - 165px);
        margin: 0 10px;
        border-radius: 30px !important; 
        position: relative; z-index: 1;
        padding: 24px 20px 40px 20px;
        overflow: visible !important;
        box-shadow: none;
    }
    #content-area::-webkit-scrollbar { display: none; }

    /* --- E. BOTTOM BAR (Floating Footer) --- */
    .sidebar {
        position: fixed !important;
        bottom: 0; left: 0; right: 0; top: auto;
        height: 80px; width: 100% !important;
        display: flex !important; flex-direction: row;
        background: #f4f4f4; 
        padding: 0; z-index: 1000;
        transition: none !important;
        
        /* FIX: FORCE SQUARE CORNERS & NO BORDERS/SHADOWS */
        border-radius: 0 !important; 
        border: none !important;
        box-shadow: none !important;
    }

    /* FOOTER SCOOPS (Corners) */
    /* FIX: Added !important to override desktop display:none */
    .sidebar::before, .sidebar::after {
        content: "" !important; 
        display: block !important;
        position: absolute; top: -30px; 
        width: 40px; height: 30px; z-index: 1000; pointer-events: none;
    }
    .sidebar::before {
        left: 0;
        background: radial-gradient(circle at top right, transparent 30px, #f4f4f4 30.5px);
    }
    .sidebar::after {
        right: 0;
        background: radial-gradient(circle at top left, transparent 30px, #f4f4f4 30.5px);
    }

    /* --- NAVIGATION ITEMS --- */
    .sidebar-top { flex-direction: row; height: 100%; width: 100%; gap: 0; }
    
    .sidebar-nav {
        display: flex; flex-direction: row; 
        height: 100%; width: 100%; gap: 0;
        justify-content: space-between; 
    }

    .nav-item {
        flex: 1; 
        display: flex; flex-direction: column; 
        align-items: center; 
        justify-content: flex-start;
        padding-top: 14px; 
        background: transparent !important; height: 100%;
        transform: none !important; box-shadow: none !important;
        transition: none !important;
        -webkit-tap-highlight-color: transparent; 
    }
    
    /* ICON CONTAINER */
    .nav-icon {
        width: 48px !important; height: 32px !important; 
        padding: 6px 14px;       
        box-sizing: border-box;  
        border-radius: 20px;
        object-fit: contain;
        background: transparent; 
        opacity: 0.5;
        display: block;          
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), background 0.2s ease !important;
        will-change: transform;
    }

    .nav-item:active .nav-icon { 
        transform: scale(0.92); 
        transition: transform 0.1s ease-out !important;
    }

    .nav-item .label {
        font-size: 12px; margin-top: -6px; line-height: 1;
        color: #999; font-weight: 500;
        transition: color 0.2s ease, font-weight 0.2s ease !important;
    }
    
    .nav-item.active .nav-icon {
        background: #ffffff; opacity: 1;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        transform: scale(1); filter: none;
    }
    .nav-item.active .label { color: #000; font-weight: 700; }

    /* Hide Desktop Elements */
    .desktop-only, .sidebar-bottom, .sidebar-top .brand { display: none !important; }

    /* =========================================
       PAGE ENTRY ANIMATION (Universal Match)
       Use the same class as app.js and style.css
    ========================================= */
    .animate-entry {
        /* No container transition to avoid conflicts */
    }

    /* Staggered Child Animation */
    .animate-entry > * {
        opacity: 0; /* Start invisible */
        animation: fadeInUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    }

    /* Reuse Delays */
    .animate-entry > *:nth-child(1) { animation-delay: 0.05s; }
    .animate-entry > *:nth-child(2) { animation-delay: 0.1s; }
    .animate-entry > *:nth-child(3) { animation-delay: 0.15s; }
    .animate-entry > *:nth-child(4) { animation-delay: 0.2s; }
    .animate-entry > *:nth-child(5) { animation-delay: 0.25s; }
    .animate-entry > *:nth-child(n+6) { animation-delay: 0.3s; }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
}